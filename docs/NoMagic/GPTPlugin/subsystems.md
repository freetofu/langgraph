# MagicGPT 플러그인 기능적 서브시스템 분석

본 문서는 기존 컨텍스트/시나리오를 기반으로 **기능적 관점의 플러그인 서브시스템**을 정의하고, 서브시스템 간 인터페이스 요구사항을 정리한다.

## 1. 서브시스템 필요성 판단
- 요구사항과 시나리오가 광범위(요구사항 도출, 모델 생성, 추적성, V&V, 규격 준수 등)이며,
- CATIA Magic 내부 데이터/외부 GPT API/사용자 인터랙션을 동시에 다루므로
**서브시스템 분리가 필요**하다고 판단한다.

## 2. 제안 서브시스템 구성

### SS-01. UI/Interaction 서브시스템
- 역할: 사용자 입력 수집, 응답 표시, 요약/상세 뷰 전환
- 주요 기능:
  - 질의 입력 패널, 응답 렌더링
  - 단계/목표 선택(요구사항/아키텍처/검증 등)
  - 사용자 승인/적용 버튼

### SS-02. Context Builder 서브시스템
- 역할: 모델 컨텍스트 수집/요약, GPT 요청에 필요한 최소 정보 구성
- 주요 기능:
  - CATIA Magic 모델 요소/관계 조회
  - 요구사항/모델 요소 요약 생성
  - 토큰 제한 대응 요약 정책 적용

### SS-03. GPT Orchestrator 서브시스템
- 역할: GPT API 요청/응답 처리 및 프롬프트 구성
- 주요 기능:
  - 사용자 의도/단계 반영 프롬프트 생성
  - API 호출, 오류 처리, 재시도
  - 응답 파싱 및 구조화

### SS-04. Proposal/Review 서브시스템
- 역할: GPT 제안을 사용자에게 검토 가능한 형태로 제공
- 주요 기능:
  - 요구사항/모델 요소/링크 제안 목록화
  - 변경 영향 요약
  - 사용자 승인 전 미리보기 제공

### SS-05. Model Apply 서브시스템
- 역할: 승인된 제안을 CATIA Magic 모델에 반영
- 주요 기능:
  - 모델 요소 생성/수정/링크 생성
  - 적용 전/후 상태 기록
  - 충돌/동시성 처리

### SS-06. Audit & Security 서브시스템
- 역할: 감사 로그 및 데이터 보호
- 주요 기능:
  - 요청/응답 로그 기록
  - 민감 정보 마스킹
  - 인증/키 관리 정책 적용

## 3. 서브시스템 간 인터페이스 분석

### 3.1 UI/Interaction ↔ Context Builder
- 전달 정보:
  - 사용자 질의, 단계/목표 선택, 모델 범위 지정
- 반환 정보:
  - 컨텍스트 요약(요구사항 목록, 모델 요소, 관계 요약)

### 3.2 Context Builder ↔ GPT Orchestrator
- 전달 정보:
  - 프롬프트에 포함될 컨텍스트 요약, 요구사항 ID/텍스트
- 반환 정보:
  - GPT 응답 결과(구조화된 제안 데이터)

### 3.3 GPT Orchestrator ↔ Proposal/Review
- 전달 정보:
  - 구조화된 제안 목록(요구사항, 모델 요소, 추적 링크, 체크리스트)
- 반환 정보:
  - 사용자가 승인/거절한 항목 목록

### 3.4 Proposal/Review ↔ Model Apply
- 전달 정보:
  - 승인된 모델 변경 세트(요소 생성, 속성 수정, 링크 생성)
- 반환 정보:
  - 적용 결과(성공/실패, 충돌/경고 메시지)

### 3.5 GPT Orchestrator ↔ Audit & Security
- 전달 정보:
  - 요청/응답 메타데이터, API 호출 결과
- 반환 정보:
  - 마스킹 정책/보안 정책 적용 결과

### 3.6 Model Apply ↔ Audit & Security
- 전달 정보:
  - 모델 변경 이력, 적용 전/후 상태 정보
- 반환 정보:
  - 감사 로그 기록 결과

## 4. 요약
- **서브시스템 분리 필요**: 복합적인 기능과 데이터 흐름을 안정적으로 관리하기 위함.
- **핵심 인터페이스**: 사용자 입력 → 컨텍스트 요약 → GPT 요청/응답 → 제안 검토 → 모델 반영 → 감사 로그.
- 이후 단계에서 각 서브시스템의 **API 스펙/데이터 스키마**를 정의해야 한다.
